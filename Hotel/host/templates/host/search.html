<!DOCTYPE html>
{% load customtags %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—É—Ç–µ—à–µ—Å—Ç–≤—É–π —Å –Ω–∞–º–∏</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/hotel.css' %}">
    <script src="{% static 'js/log.js' %}"></script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="logo">
                <h1>{% site_title %}</h1>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="#">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="#">–¢—É—Ä—ã</a></li>
                    <li><a href="#">–û –Ω–∞—Å</a></li>
                    <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                </ul>
            </nav>
            {% if request.session.user_id %}
  <div>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ request.session.user_name }}!</div>
  <a href="/profile/">üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
  <a href="/logout/">–í—ã—Ö–æ–¥</a>
{% else %}
  <a href="#" class="login-button" onclick="openLoginModal()">–í—Ö–æ–¥</a>
{% endif %}
        </div>
        <div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeLoginModal()">&times;</span>

    <!-- –§–û–†–ú–ê –í–•–û–î–ê -->
    <div id="loginForm">
      <h2>–í—Ö–æ–¥</h2>
      <form id="login-form" method="POST" action="/login/">
        {% csrf_token %}
        <input type="email" name="email" placeholder="Email" required><br>
        <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required><br>
        <button type="submit">–í–æ–π—Ç–∏</button>
      </form>
      <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="showRegisterForm()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
    </div>

    <!-- –§–û–†–ú–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò -->
    <div id="registerForm" style="display:none;">
      <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
      <form id="register-form" method="POST" action="/register/">
        {% csrf_token %}
        <input type="text" name="last_name" placeholder="–§–∞–º–∏–ª–∏—è" required><br>
        <input type="text" name="first_name" placeholder="–ò–º—è" required><br>
        <input type="email" name="email" placeholder="Email" required><br>
        <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required><br>
        <input type="tel" name="phone_number" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" required><br>
        <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </form>
      <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="showLoginForm()">–í–æ–π—Ç–∏</a></p>
    </div>
  </div>
</div>
    </header>
    <main>
        <p>–í –≥–æ—Ä–æ–¥–µ {{ location }} –Ω–∞–π–¥–µ–Ω–æ {{ hotel_count|default:"0" }} –æ—Ç–µ–ª–µ–π.</p>
    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h3>
    {% if request.session.user_id %}
    <a href="{% url 'hotel_create' %}?next={{ request.get_full_path }}" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–µ–ª—å</a>
{% endif %}

     <div class="sort-options">
    <span>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ :</span>
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by=rating">‚Üë –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É</a> |
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by=-rating">‚Üì –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É</a> |
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by=room_count">‚Üë –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–æ–º–µ—Ä–æ–≤</a> |
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by=-room_count">‚Üì –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–æ–º–µ—Ä–æ–≤</a>
    </div>
    
    {% for hotel in hotels %}
        <a href="{{ hotel.get_absolute_url }}" class="hotel-card-link">
        <div class="hotel-card">
            <div class="hotel-photo">
                {% if hotel.photo %}
                    <img src="{{ hotel.photo.url }}" alt="{{ hotel.name }}">
                {% else %}
                    <img src="{% static 'img/no-image.png' %}" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
                {% endif %}
                <div class="rating-stars">
    {% for i in "12345" %}
        {% if forloop.counter <= hotel.rating %}
            ‚òÖ
        {% else %}
            ‚òÜ
        {% endif %}
    {% endfor %}
</div>

            </div>

            <div class="hotel-info">
                <h4>{{ hotel.name|upper|truncatechars:15 }}</h4>
                </a>
                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ hotel.description }}</p>
                <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç—ã:</strong> {{ hotel.contact_info }}</p>
                <p><strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> {{ hotel.location }}</p>
                <strong>–£–¥–æ–±—Å—Ç–≤–∞:</strong>
    {% for ha in hotel.hotelamenity_set.all %}
        <span class="badge bg-secondary">{{ ha.amenity.name }}</span>
        
    {% endfor %}
            </div>
        </div>
        
        {% if request.session.user_id %}
            <div class="hotel-actions">
                <a href="{% url 'hotel_update' hotel.id %}?next={{ request.get_full_path }}" class="btn btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="{% url 'hotel_delete' hotel.id %}?next={{ request.get_full_path }}" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</a>
                <a href="{% url 'hotel_edit_amenities' hotel.id %}?next={{ request.get_full_path }}" class="btn btn-info">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É–¥–æ–±—Å—Ç–≤–∞</a>
            </div>
        {% endif %}
        
    {% empty %}
        <p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
    {% endfor %}
    
    
    <div class="pagination">
  {% if hotels.has_previous %}
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by={{ sort_by }}&page={{ hotels.previous_page_number }}">–ù–∞–∑–∞–¥</a>
  {% endif %}

  <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ hotels.number }} –∏–∑ {{ hotels.paginator.num_pages }}</span>

  {% if hotels.has_next %}
    <a href="?location={{ location }}&check_in={{ check_in }}&sort_by={{ sort_by }}&page={{ hotels.next_page_number }}">–í–ø–µ—Ä–µ–¥</a>
  {% endif %}
</div>
</main>
    